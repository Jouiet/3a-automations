<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3A Global MCP | Observability Dashboard</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="mcp-observability.css">
    .grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 24px;
    margin-bottom: 40px;
    }

    .card {
    background: var(--card-bg);
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 20px;
    padding: 24px;
    transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .card:hover {
    transform: translateY(-5px);
    border-color: var(--accent);
    }

    .card-label {
    color: var(--text-dim);
    font-size: 0.9rem;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    }

    .card-value {
    font-size: 2.5rem;
    font-weight: 600;
    font-family: 'JetBrains Mono', monospace;
    }

    .main-content {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 24px;
    }

    .panel {
    background: var(--card-bg);
    border-radius: 20px;
    padding: 30px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    }

    h2 {
    margin-top: 0;
    font-size: 1.5rem;
    margin-bottom: 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    }

    .log-list {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    }

    .log-entry {
    padding: 12px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    display: grid;
    grid-template-columns: 180px 100px 1fr;
    gap: 15px;
    }

    .log-ts {
    color: var(--text-dim);
    }

    .log-level {
    font-weight: bold;
    }

    .log-level.INFO {
    color: var(--accent);
    }

    .log-level.ERROR {
    color: var(--error);
    }

    .log-msg {
    color: var(--text);
    }

    .tool-list {
    list-style: none;
    padding: 0;
    margin: 0;
    }

    .tool-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    border-radius: 10px;
    margin-bottom: 8px;
    background: rgba(255, 255, 255, 0.02);
    }

    .tool-name {
    font-weight: 600;
    }

    .tool-usage {
    color: var(--accent);
    font-family: 'JetBrains Mono', monospace;
    }

    .glass-btn {
    background: rgba(79, 186, 241, 0.1);
    color: var(--accent);
    border: 1px solid var(--accent);
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: inherit;
    font-weight: 600;
    }

    .glass-btn:hover {
    background: var(--accent);
    color: var(--bg);
    box-shadow: 0 0 15px var(--accent-glow);
    }
    .text-accent { color: var(--accent); }
    .text-success { color: var(--success); }

    /* Utility Classes for Charts */
    .w-full { width: 100%; }
    .w-65 { width: 65%; }
    .w-99 { width: 99%; }
    .w-20 { width: 20%; }
    .success-bar { background: var(--accent-success); box-shadow: 0 0 10px rgba(48,209,88,0.3); }
    .bg-gray { background: #9CA3AF; }
    .blend-overlay { mix-blend-mode: overlay; }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <div class="logo-box">
                <!-- Inline SVG Logo -->
                <svg class="logo-svg" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="40" height="40" rx="10" fill="url(#paint0_linear)" />
                    <path d="M12 28L20 12L28 28H23L20 20L17 28H12Z" fill="white" font-weight="900"
                        class="blend-overlay" />
                    <defs>
                        <linearGradient id="paint0_linear" x1="0" y1="0" x2="40" y2="40" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#2997FF" />
                            <stop offset="1" stop-color="#1E40AF" />
                        </linearGradient>
                    </defs>
                </svg>
                <h1><strong>MCP</strong> OBSERVER</h1>
            </div>
            <div class="status-module">
                <div class="status-dot pulse-animation"></div>
                SYSTEM AUTONOMOUS â€¢ LEVEL 5 (SAFE MODE)
            </div>
        </header>

        <div class="kpi-grid">
            <div class="card">
                <h3>Active Tools</h3>
                <div class="value text-gradient">118</div>
                <div class="mini-chart">
                    <div class="mini-chart-bar w-full"></div>
                </div>
            </div>
            <div class="card">
                <h3>Requests (24h)</h3>
                <div class="value text-gradient">1,284</div>
                <div class="mini-chart">
                    <div class="mini-chart-bar w-65"></div>
                </div>
            </div>
            <div class="card">
                <h3>Success Rate</h3>
                <div class="value text-success">99.8%</div>
                <div class="mini-chart">
                    <div class="mini-chart-bar w-99 success-bar">
                    </div>
                </div>
            </div>
            <div class="card">
                <h3>Latency (avg)</h3>
                <div class="value text-gradient">42ms</div>
                <div class="mini-chart">
                    <div class="mini-chart-bar w-20 bg-gray"></div>
                </div>
            </div>
        </div>

        <div class="panels-grid">
            <div class="panel">
                <div class="panel-header">
                    <h2>Live Tool Invocations</h2>
                    <button class="glass-btn">Export Log</button>
                </div>
                <div class="log-stream">
                    <!-- Logs injected via JS -->
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <h2>Top Tools</h2>
                </div>
                <ul class="tool-list">
                    <!-- Tools injected via JS -->
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Inline Mock Data (No Fetch Required)
        async function fetchRealLogs() {
            try {
                const response = await fetch('../landing-page-hostinger/data/mcp-logs.json');
                if (!response.ok) throw new Error('Log file not found');
                const logs = await response.json();
                return logs;
            } catch (e) {
                console.warn('Failed to fetch real logs, using mock data:', e);
                return MOCK_LOGS_FALLBACK;
            }
        }

        // Fallback Data
        const MOCK_LOGS_FALLBACK = [
            { timestamp: Date.now(), agent: 'System', action: 'dashboard_init', status: 'INFO', details: 'Waiting for live agent data...' }
        ];

        const TOP_TOOLS = [
            { name: 'generate_blog_post', count: 342 },
            { name: 'scrape_google_maps', count: 218 },
            { name: 'run_voice_api', count: 195 },
            { name: 'meta_leads_sync', count: 156 },
            { name: 'product_enrichment', count: 94 }
        ];

        async function renderDashboard() {
            // 0. Fetch Data
            const logs = await fetchRealLogs();

            // 1. Render Logs
            const logStream = document.querySelector('.log-stream');
            logStream.innerHTML = '';

            logs.forEach(log => {
                const entry = document.createElement('div');
                entry.className = 'log-entry';
                const timeStr = new Date(log.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                entry.innerHTML = `
                    <span class="log-ts">${timeStr}</span>
                    <span class="log-level ${log.status}">${log.status}</span>
                    <span class="log-msg"><strong>${log.agent}</strong>: ${log.action}</span>
                `;
                logStream.appendChild(entry);
            });

            // 2. Render Top Tools
            const toolList = document.querySelector('.tool-list');
            toolList.innerHTML = '';
            TOP_TOOLS.forEach(tool => {
                const li = document.createElement('li');
                li.className = 'tool-item';
                li.innerHTML = `
                    <span class="tool-name">${tool.name}</span>
                    <span class="tool-hits">${tool.count}</span>
                `;
                toolList.appendChild(li);
            });
        }

        // Initialize
        renderDashboard();

        // Auto-refresh every 5 seconds (Real-time polling)
        setInterval(() => {
            renderDashboard();
        }, 5000);
    </script>
</body>

</html>