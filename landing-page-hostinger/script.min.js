!function(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&("2g"===e.effectiveType||"slow-2g"===e.effectiveType||!0===e.saveData),n=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if((t||n)&&document.body.classList.add("lite"),!n){const e=()=>{document.body.classList.remove("lite")};["scroll","click","touchstart","keydown"].forEach((t=>{window.addEventListener(t,e,{once:!0,passive:!0})}))}}(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("nav-toggle"),t=document.getElementById("nav-menu");e&&t&&(e.addEventListener("click",(()=>{e.classList.toggle("active"),t.classList.toggle("active"),document.body.classList.toggle("nav-open")})),t.querySelectorAll("a").forEach((n=>{n.addEventListener("click",(()=>{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("nav-open")}))})),document.addEventListener("click",(n=>{t.contains(n.target)||e.contains(n.target)||(e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("nav-open"))}))),document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));if(t){const e=document.querySelector(".header").offsetHeight,n=t.getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:n,behavior:"smooth"})}}))}));const n=document.querySelector(".header");let o=0;window.addEventListener("scroll",(()=>{const e=window.pageYOffset;e>100?(n.style.background="rgba(25, 30, 53, 0.98)",n.style.boxShadow="0 4px 30px rgba(79, 186, 241, 0.1)"):(n.style.background="rgba(25, 30, 53, 0.9)",n.style.boxShadow="none"),o=e}));const a=document.getElementById("audit-form"),r=document.getElementById("form-success"),s=document.getElementById("form-error"),c="https://script.google.com/macros/s/AKfycbyzIHwTDfQpm57LBloFJ53BMkSvsSDd3zCXE41mMSFPMa1m6xOuji3ICKQJA1oiHb-4/exec",i="https://script.google.com/macros/s/AKfycbzFP751mwK04FguPrIISQlMHHUULw5-e-n_Pn63h-SXEBOUvD-wpM7wmbGDPauGdzIZ/exec",l="contact@3a-automation.com",d=5e3;if(a){const e=document.getElementById("form-timestamp");e&&(e.value=(new Date).toISOString()),a.addEventListener("submit",(async function(e){e.preventDefault();const t=a.querySelector('button[type="submit"]'),n=t.querySelector(".btn-text"),o=n?n.textContent:t.textContent;r&&(r.style.display="none"),s&&(s.style.display="none"),n?n.textContent="Envoi en cours...":t.textContent="Envoi en cours...",t.disabled=!0,t.style.opacity="0.7";const m=new FormData(a),u=Object.fromEntries(m.entries());u.timestamp=(new Date).toISOString(),u.userAgent=navigator.userAgent,u.referrer=document.referrer||"direct",u.page=window.location.href;let g=!1;const y=async()=>{try{const e={id:"lead_"+Date.now(),name:u.name||"Unknown",email:u.email||"",phone:u.phone||"",company:u.company||u.website||"",source:"website-form",status:"new",score:50,priority:"medium",notes:`Subject: ${u.subject||"N/A"}\nMessage: ${u.message||u.challenges||"N/A"}\nPage: ${u.page}`,tags:["website",u.subject||"general"].filter(Boolean),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},t=new URLSearchParams({action:"create",sheet:"Leads",data:JSON.stringify(e)});await fetch(`${i}?${t}`,{method:"GET"})}catch(e){console.log("Dashboard lead creation failed (non-blocking):",e)}};try{const e=new AbortController,t=setTimeout((()=>e.abort()),d),n=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u),signal:e.signal});clearTimeout(t),n.ok&&(g=!0,y())}catch(e){console.log("Webhook unavailable, trying fallback..."),y()}if(!g){const e=encodeURIComponent(`[3A Automation] ${u.subject||"Demande"} - ${u.name}`),t=encodeURIComponent(`Nom: ${u.name||"Non spÃ©cifiÃ©"}\nEmail: ${u.email||"Non spÃ©cifiÃ©"}\nEntreprise: ${u.company||"Non spÃ©cifiÃ©"}\nSite web: ${u.website||"Non spÃ©cifiÃ©"}\nSujet: ${u.subject||"Non spÃ©cifiÃ©"}\nPlateforme: ${u.platform||"Non spÃ©cifiÃ©"}\nPays: ${u.country||"Non spÃ©cifiÃ©"}\n\n--- Message ---\n${u.message||u.challenges||"Pas de message"}\n\n--- MÃ©tadonnÃ©es ---\nSource: ${u.source||"website"}\nPage: ${u.page}\nDate: ${u.timestamp}`);window.location.href=`mailto:${l}?subject=${e}&body=${t}`,g=!0}g?(a.style.display="none",r&&(r.style.display="flex",r.classList.add("animated")),"function"==typeof gtag&&gtag("event","generate_lead",{event_category:"engagement",event_label:u.subject||u.service||"audit-request",value:1}),a.reset()):s&&(s.style.display="flex",s.classList.add("animated")),n?n.textContent=o:t.textContent=o,t.disabled=!1,t.style.opacity="1"}))}const m=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)",m.unobserve(e.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"}),u=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=parseInt(e.target.dataset.count);t&&((e,t)=>{const n=performance.now(),o=a=>{const r=a-n,s=Math.min(r/2e3,1),c=1-Math.pow(1-s,4),i=Math.floor(0+(t-0)*c);e.textContent=i+(e.dataset.suffix||""),s<1?requestAnimationFrame(o):e.textContent=t+(e.dataset.suffix||"")};requestAnimationFrame(o)})(e.target,t),u.unobserve(e.target)}}))}),{threshold:.5});document.querySelectorAll(".stat-number-ultra[data-count]").forEach((e=>{u.observe(e)}));const g=document.querySelectorAll(".flywheel-stage"),y=document.querySelector(".flywheel-center-hub");g.forEach((e=>{e.addEventListener("mouseenter",(()=>{g.forEach((t=>{t!==e&&(t.style.opacity="0.5")})),y&&(y.style.transform="translate(-50%, -50%) scale(1.1)")})),e.addEventListener("mouseleave",(()=>{g.forEach((e=>{e.style.opacity="1"})),y&&(y.style.transform="translate(-50%, -50%) scale(1)")}))}));document.querySelectorAll(".orbital-ring").forEach((e=>{e.addEventListener("mouseenter",(()=>{e.style.animationPlayState="paused"})),e.addEventListener("mouseleave",(()=>{e.style.animationPlayState="running"}))}));const p=document.querySelectorAll(".cyber-glow");p.length>0&&window.addEventListener("scroll",(()=>{const e=window.pageYOffset;p.forEach(((t,n)=>{const o=.1+.05*n;t.style.transform=`translateY(${e*o}px)`}))}),{passive:!0});document.querySelectorAll(".form-field input, .form-field textarea").forEach((e=>{e.addEventListener("focus",(()=>{e.parentElement.classList.add("focused")})),e.addEventListener("blur",(()=>{e.value||e.parentElement.classList.remove("focused")}))}));const f=document.createElement("div");let v;f.className="cursor-glow",f.style.cssText="\n    position: fixed;\n    width: 300px;\n    height: 300px;\n    background: radial-gradient(circle, rgba(79, 186, 241, 0.05) 0%, transparent 70%);\n    border-radius: 50%;\n    pointer-events: none;\n    z-index: 0;\n    transform: translate(-50%, -50%);\n    transition: opacity 0.3s ease;\n    opacity: 0;\n  ",document.body.appendChild(f),document.addEventListener("mousemove",(e=>{f.style.left=e.clientX+"px",f.style.top=e.clientY+"px",f.style.opacity="1",clearTimeout(v),v=setTimeout((()=>{f.style.opacity="0"}),1e3)})),"ontouchstart"in window&&(f.style.display="none");const h=document.getElementById("cookie-consent"),b=document.getElementById("cookie-accept"),w=document.getElementById("cookie-reject"),E="3a_cookie_consent",_=localStorage.getItem(E);function L(e){localStorage.setItem(E,e),h&&(h.style.animation="slideUp 0.3s ease reverse forwards",setTimeout((()=>{h.style.display="none"}),300))}function x(){"function"==typeof gtag&&gtag("consent","update",{analytics_storage:"granted",ad_storage:"granted"}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cookie_consent_granted",consent_type:"all"})}!_&&h?setTimeout((()=>{h.style.display="block"}),1e3):"accepted"===_&&x(),b&&b.addEventListener("click",(()=>{L("accepted"),x()})),w&&w.addEventListener("click",(()=>{L("rejected"),"function"==typeof gtag&&gtag("consent","update",{analytics_storage:"denied",ad_storage:"denied"}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cookie_consent_rejected",consent_type:"none"})})),function(){if("function"!=typeof gtag)return;const e=Date.now();let t=0,n=!0;document.addEventListener("visibilitychange",(()=>{document.hidden?(t+=Date.now()-e,n=!1):n=!0})),window.addEventListener("beforeunload",(()=>{const o=n?t+(Date.now()-e):t,a=Math.round(o/1e3);a>5&&gtag("event","time_on_page",{event_category:"engagement",event_label:window.location.pathname,value:a,time_bucket:a<30?"under_30s":a<60?"30s_to_1m":a<180?"1m_to_3m":"over_3m"})}));const o=[25,50,75,100],a=new Set;let r;window.addEventListener("scroll",(()=>{r||(r=setTimeout((()=>{(()=>{const e=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);o.forEach((t=>{e>=t&&!a.has(t)&&(a.add(t),gtag("event","scroll_depth",{event_category:"engagement",event_label:window.location.pathname,value:t,percent_scrolled:t}))}))})(),r=null}),200))}),{passive:!0}),document.querySelectorAll('a.btn-cyber, a.btn-primary, a.cta-button, .cta-section a, a[href*="booking"]').forEach((e=>{e.addEventListener("click",(t=>{const n=e.textContent.trim().substring(0,50),o=e.getAttribute("href")||"";gtag("event","cta_click",{event_category:"conversion",event_label:n,cta_destination:o,page_section:e.closest("section")?.className||"unknown"})}))}));document.querySelectorAll("form").forEach((e=>{let t=!1;const n=e.id||e.className||"unknown_form";e.querySelectorAll("input, textarea, select").forEach((e=>{e.addEventListener("focus",(()=>{t||(t=!0,gtag("event","form_start",{event_category:"form_engagement",event_label:n,form_id:n}))}),{once:!0})})),window.addEventListener("beforeunload",(()=>{t&&!e.classList.contains("submitted")&&gtag("event","form_abandon",{event_category:"form_engagement",event_label:n,form_id:n})})),e.addEventListener("submit",(()=>{e.classList.add("submitted"),gtag("event","form_submit",{event_category:"form_engagement",event_label:n,form_id:n})}))})),document.querySelectorAll('a[href^="http"]').forEach((e=>{const t=e.getAttribute("href");t.includes(window.location.hostname)||e.addEventListener("click",(()=>{gtag("event","outbound_click",{event_category:"outbound",event_label:t,transport_type:"beacon"})}))})),document.querySelectorAll(".pricing-card, .retainer-card").forEach((e=>{e.addEventListener("click",(()=>{const t=e.querySelector("h3")?.textContent||e.querySelector(".retainer-name")?.textContent||"unknown";gtag("event","pricing_click",{event_category:"pricing",event_label:t.trim()})}))})),document.querySelectorAll(".currency-btn, .period-btn").forEach((e=>{e.addEventListener("click",(()=>{const t=e.classList.contains("currency-btn")?"currency":"period",n=e.dataset.currency||e.dataset.period||e.textContent.trim();gtag("event","pricing_toggle",{event_category:"pricing",event_label:`${t}_${n}`,toggle_type:t,toggle_value:n})}))})),console.log("ðŸ“Š Advanced Analytics initialized")}();document.querySelectorAll(".btn-cyber").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width*100,a=(t.clientY-n.top)/n.height*100;e.style.setProperty("--mouse-x",`${o}%`),e.style.setProperty("--mouse-y",`${a}%`)}))}));document.querySelectorAll(".service-card-ultra, .flow-card, .feature-card").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=t.clientX-n.left,a=t.clientY-n.top,r=n.width/2,s=(a-n.height/2)/20,c=(r-o)/20;e.style.transform=`perspective(1000px) rotateX(${s}deg) rotateY(${c}deg) translateZ(10px)`})),e.addEventListener("mouseleave",(()=>{e.style.transform="perspective(1000px) rotateX(0) rotateY(0) translateZ(0)",e.style.transition="transform 0.5s ease"})),e.addEventListener("mouseenter",(()=>{e.style.transition="none"}))}));const S=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target,n=parseInt(t.dataset.count),o=t.dataset.suffix||"",a=t.textContent.includes("+");if(n){let e=0;const r=n/(2500/16),s=()=>{e+=r,e>=n?t.textContent=n+(a?"+":"")+o:(t.textContent=Math.floor(e)+o,requestAnimationFrame(s))};s()}S.unobserve(t)}}))}),{threshold:.5});document.querySelectorAll("[data-count]").forEach((e=>{S.observe(e)}));document.querySelectorAll(".btn-primary-cyber").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=t.clientX-n.left-n.width/2,a=t.clientY-n.top-n.height/2;e.style.transform=`translate(${.3*o}px, ${.3*a}px)`})),e.addEventListener("mouseleave",(()=>{e.style.transform="translate(0, 0)"}))}));const A=(e,t)=>{const n=document.createElement("div");n.style.cssText=`\n      position: fixed;\n      width: 4px;\n      height: 4px;\n      background: var(--primary);\n      border-radius: 50%;\n      pointer-events: none;\n      z-index: 9999;\n      left: ${e}px;\n      top: ${t}px;\n      box-shadow: 0 0 10px var(--primary);\n    `,document.body.appendChild(n);const o=Math.random()*Math.PI*2,a=50*Math.random()+30,r=Math.cos(o)*a,s=Math.sin(o)*a;let c=1,i=e,l=t;const d=()=>{i+=.016*r,l+=.016*s,c-=.02,n.style.left=i+"px",n.style.top=l+"px",n.style.opacity=c,c>0?requestAnimationFrame(d):n.remove()};requestAnimationFrame(d)};document.addEventListener("click",(e=>{for(let t=0;t<8;t++)setTimeout((()=>A(e.clientX,e.clientY)),30*t)})),(()=>{const e=document.querySelectorAll("[data-animate]"),t=document.querySelectorAll("[data-animate-stagger]"),n=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.classList.add("animated"),n.unobserve(e.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"});e.forEach((e=>n.observe(e))),t.forEach((e=>n.observe(e)))})(),console.log("3A Automation - Ultra Futuristic Site v3.1 Initialized")}));