!function(){const e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e&&("2g"===e.effectiveType||"slow-2g"===e.effectiveType||!0===e.saveData),n=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if((t||n)&&document.body.classList.add("lite"),!n){const e=()=>{document.body.classList.remove("lite")};["scroll","click","touchstart","keydown"].forEach((t=>{window.addEventListener(t,e,{once:!0,passive:!0})}))}}(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("nav-toggle"),t=document.getElementById("nav-menu");e&&t&&(e.addEventListener("click",(()=>{e.classList.toggle("active"),t.classList.toggle("active"),document.body.classList.toggle("nav-open")})),t.querySelectorAll("a").forEach((n=>{n.addEventListener("click",(()=>{e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("nav-open")}))})),document.addEventListener("click",(n=>{t.contains(n.target)||e.contains(n.target)||(e.classList.remove("active"),t.classList.remove("active"),document.body.classList.remove("nav-open"))}))),document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));if(t){const e=document.querySelector(".header").offsetHeight,n=t.getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:n,behavior:"smooth"})}}))}));const n=document.querySelector(".header");let o=0;window.addEventListener("scroll",(()=>{const e=window.pageYOffset;e>100?(n.style.background="rgba(25, 30, 53, 0.98)",n.style.boxShadow="0 4px 30px rgba(79, 186, 241, 0.1)"):(n.style.background="rgba(25, 30, 53, 0.9)",n.style.boxShadow="none"),o=e}));const a=document.getElementById("audit-form"),s=document.getElementById("form-success"),r=document.getElementById("form-error"),c="https://script.google.com/macros/s/AKfycbyzIHwTDfQpm57LBloFJ53BMkSvsSDd3zCXE41mMSFPMa1m6xOuji3ICKQJA1oiHb-4/exec",i="https://script.google.com/macros/s/AKfycbzFP751mwK04FguPrIISQlMHHUULw5-e-n_Pn63h-SXEBOUvD-wpM7wmbGDPauGdzIZ/exec",l="contact@3a-automation.com",d=5e3;if(a){const e=document.getElementById("form-timestamp");e&&(e.value=(new Date).toISOString()),a.addEventListener("submit",(async function(e){e.preventDefault();const t=a.querySelector('button[type="submit"]'),n=t.querySelector(".btn-text"),o=n?n.textContent:t.textContent;s&&(s.style.display="none"),r&&(r.style.display="none"),n?n.textContent="Envoi en cours...":t.textContent="Envoi en cours...",t.disabled=!0,t.style.opacity="0.7";const m=new FormData(a),u=Object.fromEntries(m.entries());u.timestamp=(new Date).toISOString(),u.userAgent=navigator.userAgent,u.referrer=document.referrer||"direct",u.page=window.location.href;let y=!1;const p=async()=>{try{const e={id:"lead_"+Date.now(),name:u.name||"Unknown",email:u.email||"",phone:u.phone||"",company:u.company||u.website||"",source:"website-form",status:"new",score:50,priority:"medium",notes:`Subject: ${u.subject||"N/A"}\nMessage: ${u.message||u.challenges||"N/A"}\nPage: ${u.page}`,tags:["website",u.subject||"general"].filter(Boolean),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},t=new URLSearchParams({action:"create",sheet:"Leads",data:JSON.stringify(e)});await fetch(`${i}?${t}`,{method:"GET"})}catch(e){console.log("Dashboard lead creation failed (non-blocking):",e)}};try{const e=new AbortController,t=setTimeout((()=>e.abort()),d),n=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u),signal:e.signal});clearTimeout(t),n.ok&&(y=!0,p())}catch(e){console.log("Webhook unavailable, trying fallback..."),p()}if(!y){const e=encodeURIComponent(`[3A Automation] ${u.subject||"Demande"} - ${u.name}`),t=encodeURIComponent(`Nom: ${u.name||"Non spécifié"}\nEmail: ${u.email||"Non spécifié"}\nEntreprise: ${u.company||"Non spécifié"}\nSite web: ${u.website||"Non spécifié"}\nSujet: ${u.subject||"Non spécifié"}\nPlateforme: ${u.platform||"Non spécifié"}\nPays: ${u.country||"Non spécifié"}\n\n--- Message ---\n${u.message||u.challenges||"Pas de message"}\n\n--- Métadonnées ---\nSource: ${u.source||"website"}\nPage: ${u.page}\nDate: ${u.timestamp}`);window.location.href=`mailto:${l}?subject=${e}&body=${t}`,y=!0}y?(a.style.display="none",s&&(s.style.display="flex",s.classList.add("animated")),"function"==typeof gtag&&gtag("event","generate_lead",{event_category:"engagement",event_label:u.subject||u.service||"audit-request",value:1}),a.reset()):r&&(r.style.display="flex",r.classList.add("animated")),n?n.textContent=o:t.textContent=o,t.disabled=!1,t.style.opacity="1"}))}const m=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)",m.unobserve(e.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"});[".service-card-ultra",".flywheel-stage",".process-step-ultra",".tech-item",".feature-card",".flow-card"].forEach((e=>{document.querySelectorAll(e).forEach(((e,t)=>{e.style.opacity="0",e.style.transform="translateY(20px)",e.style.transition=`opacity 0.5s ease ${.08*t}s, transform 0.5s ease ${.08*t}s`,m.observe(e)}))}));const u=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=parseInt(e.target.dataset.count);t&&((e,t)=>{const n=performance.now(),o=a=>{const s=a-n,r=Math.min(s/2e3,1),c=1-Math.pow(1-r,4),i=Math.floor(0+(t-0)*c);e.textContent=i+(e.dataset.suffix||""),r<1?requestAnimationFrame(o):e.textContent=t+(e.dataset.suffix||"")};requestAnimationFrame(o)})(e.target,t),u.unobserve(e.target)}}))}),{threshold:.5});document.querySelectorAll(".stat-number-ultra[data-count]").forEach((e=>{u.observe(e)}));const y=document.querySelectorAll(".flywheel-stage"),p=document.querySelector(".flywheel-center-hub");y.forEach((e=>{e.addEventListener("mouseenter",(()=>{y.forEach((t=>{t!==e&&(t.style.opacity="0.5")})),p&&(p.style.transform="translate(-50%, -50%) scale(1.1)")})),e.addEventListener("mouseleave",(()=>{y.forEach((e=>{e.style.opacity="1"})),p&&(p.style.transform="translate(-50%, -50%) scale(1)")}))}));document.querySelectorAll(".orbital-ring").forEach((e=>{e.addEventListener("mouseenter",(()=>{e.style.animationPlayState="paused"})),e.addEventListener("mouseleave",(()=>{e.style.animationPlayState="running"}))}));const g=document.querySelectorAll(".cyber-glow");g.length>0&&window.addEventListener("scroll",(()=>{const e=window.pageYOffset;g.forEach(((t,n)=>{const o=.1+.05*n;t.style.transform=`translateY(${e*o}px)`}))}),{passive:!0});document.querySelectorAll(".form-field input, .form-field textarea").forEach((e=>{e.addEventListener("focus",(()=>{e.parentElement.classList.add("focused")})),e.addEventListener("blur",(()=>{e.value||e.parentElement.classList.remove("focused")}))}));const f=document.createElement("div");let v;f.className="cursor-glow",f.style.cssText="\n    position: fixed;\n    width: 300px;\n    height: 300px;\n    background: radial-gradient(circle, rgba(79, 186, 241, 0.05) 0%, transparent 70%);\n    border-radius: 50%;\n    pointer-events: none;\n    z-index: 0;\n    transform: translate(-50%, -50%);\n    transition: opacity 0.3s ease;\n    opacity: 0;\n  ",document.body.appendChild(f),document.addEventListener("mousemove",(e=>{f.style.left=e.clientX+"px",f.style.top=e.clientY+"px",f.style.opacity="1",clearTimeout(v),v=setTimeout((()=>{f.style.opacity="0"}),1e3)})),"ontouchstart"in window&&(f.style.display="none");const h=document.getElementById("cookie-consent"),b=document.getElementById("cookie-accept"),w=document.getElementById("cookie-reject"),E="3a_cookie_consent",x=localStorage.getItem(E);function L(e){localStorage.setItem(E,e),h&&(h.style.animation="slideUp 0.3s ease reverse forwards",setTimeout((()=>{h.style.display="none"}),300))}function S(){"function"==typeof gtag&&gtag("consent","update",{analytics_storage:"granted",ad_storage:"granted"}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cookie_consent_granted",consent_type:"all"})}!x&&h?setTimeout((()=>{h.style.display="block"}),1e3):"accepted"===x&&S(),b&&b.addEventListener("click",(()=>{L("accepted"),S()})),w&&w.addEventListener("click",(()=>{L("rejected"),"function"==typeof gtag&&gtag("consent","update",{analytics_storage:"denied",ad_storage:"denied"}),window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cookie_consent_rejected",consent_type:"none"})}));document.querySelectorAll(".btn-cyber").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width*100,a=(t.clientY-n.top)/n.height*100;e.style.setProperty("--mouse-x",`${o}%`),e.style.setProperty("--mouse-y",`${a}%`)}))}));document.querySelectorAll(".service-card-ultra, .flow-card, .feature-card").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=t.clientX-n.left,a=t.clientY-n.top,s=n.width/2,r=(a-n.height/2)/20,c=(s-o)/20;e.style.transform=`perspective(1000px) rotateX(${r}deg) rotateY(${c}deg) translateZ(10px)`})),e.addEventListener("mouseleave",(()=>{e.style.transform="perspective(1000px) rotateX(0) rotateY(0) translateZ(0)",e.style.transition="transform 0.5s ease"})),e.addEventListener("mouseenter",(()=>{e.style.transition="none"}))}));const I=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target,n=parseInt(t.dataset.count),o=t.dataset.suffix||"",a=t.textContent.includes("+");if(n){let e=0;const s=n/(2500/16),r=()=>{e+=s,e>=n?t.textContent=n+(a?"+":"")+o:(t.textContent=Math.floor(e)+o,requestAnimationFrame(r))};r()}I.unobserve(t)}}))}),{threshold:.5});document.querySelectorAll("[data-count]").forEach((e=>{I.observe(e)}));document.querySelectorAll(".btn-primary-cyber").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=t.clientX-n.left-n.width/2,a=t.clientY-n.top-n.height/2;e.style.transform=`translate(${.3*o}px, ${.3*a}px)`})),e.addEventListener("mouseleave",(()=>{e.style.transform="translate(0, 0)"}))}));const A=(e,t)=>{const n=document.createElement("div");n.style.cssText=`\n      position: fixed;\n      width: 4px;\n      height: 4px;\n      background: var(--primary);\n      border-radius: 50%;\n      pointer-events: none;\n      z-index: 9999;\n      left: ${e}px;\n      top: ${t}px;\n      box-shadow: 0 0 10px var(--primary);\n    `,document.body.appendChild(n);const o=Math.random()*Math.PI*2,a=50*Math.random()+30,s=Math.cos(o)*a,r=Math.sin(o)*a;let c=1,i=e,l=t;const d=()=>{i+=.016*s,l+=.016*r,c-=.02,n.style.left=i+"px",n.style.top=l+"px",n.style.opacity=c,c>0?requestAnimationFrame(d):n.remove()};requestAnimationFrame(d)};document.addEventListener("click",(e=>{for(let t=0;t<8;t++)setTimeout((()=>A(e.clientX,e.clientY)),30*t)}));const $=document.querySelectorAll("section"),C=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&e.target.classList.add("section-visible")}))}),{threshold:.05,rootMargin:"100px 0px -50px 0px"});$.forEach(((e,t)=>{0!==t?(e.classList.add("section-hidden"),C.observe(e)):e.classList.add("section-visible")})),setTimeout((()=>{$.forEach((e=>{e.classList.contains("section-visible")||e.classList.add("section-visible")}))}),3e3);const k=document.createElement("style");k.textContent="\n    .section-hidden {\n      opacity: 0;\n      transform: translateY(40px);\n      transition: opacity 0.8s ease, transform 0.8s ease;\n    }\n    .section-visible {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  ",document.head.appendChild(k),(()=>{const e=document.querySelectorAll("[data-animate]"),t=document.querySelectorAll("[data-animate-stagger]"),n=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(e.target.classList.add("animated"),n.unobserve(e.target))}))}),{threshold:.1,rootMargin:"0px 0px -50px 0px"});e.forEach((e=>n.observe(e))),t.forEach((e=>n.observe(e)))})(),console.log("3A Automation - Ultra Futuristic Site v3.1 Initialized")}));